<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>DeepShield Verification Dashboard</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<style>
body {
  margin: 0;
  font-family: 'Inter', sans-serif;
  background: #1f1f2e;
  color: #fff;
  padding: 20px;
}
.container { max-width: 1200px; margin:auto; }
h2 { color:#6c63ff; text-align:center; margin-bottom:20px; }
.top-row { display:flex; gap:20px; justify-content:center; margin-bottom:25px; }
.card { background:#2a2a3e; border-radius:15px; padding:20px; box-shadow:0 8px 20px rgba(0,0,0,0.4); display:flex; flex-direction:column; justify-content:center; }
.card h3 { color:#ffb400; margin-bottom:15px; }
#webcam { width:100%; height:220px; border-radius:12px; background:#000; margin-bottom:15px; }
#verifyBtn { padding:10px 20px; font-size:0.95em; border:none; border-radius:8px; background:#6c63ff; color:#fff; cursor:pointer; width:100%; transition:0.3s; }
#verifyBtn:disabled { background:#555; cursor:not-allowed; }
#featureChart,#circleChart,#trendChart{ width:100% !important; height:250px !important; }
.dashboard{ display:flex; gap:20px; justify-content:center; }
.feature-legend{ display:flex; gap:10px; justify-content:center; margin-top:10px; }
.feature-legend span{ display:flex; align-items:center; gap:5px; font-size:0.9em; }
.color-box{ width:15px; height:15px; border-radius:4px; display:inline-block; }
</style>
</head>
<body>

<div class="container">
  <h2>üõ°Ô∏è DeepShield Verification Dashboard</h2>

  <!-- Top row: Webcam + Trend -->
  <div class="top-row">
    <div class="card" style="flex:1 1 400px; max-width:450px;">
      <h3>Camera Feed</h3>
      <video id="webcam" autoplay muted></video>
      <button id="verifyBtn" disabled>Waiting...</button>
    </div>

    <div class="card" style="flex:1 1 500px; max-width:600px;">
      <h3>Performance Trend</h3>
      <canvas id="trendChart"></canvas>
    </div>
  </div>

  <!-- Bottom row: Feature + Doughnut -->
  <div class="dashboard">
    <div class="card" style="flex:1 1 400px;">
      <h3>Feature Detection Accuracy</h3>
      <canvas id="featureChart"></canvas>
      <div class="feature-legend">
        <span><div class="color-box" style="background:#6c63ff"></div> Blinking</span>
        <span><div class="color-box" style="background:#ff6584"></div> Facial</span>
        <span><div class="color-box" style="background:#00d2d3"></div> Voice</span>
        <span><div class="color-box" style="background:#ffb400"></div> Head</span>
      </div>
    </div>

    <div class="card" style="flex:1 1 250px;">
      <h3>Overall Accuracy</h3>
      <canvas id="circleChart"></canvas>
      <p style="text-align:center;font-size:1.3em;margin-top:10px;" id="overallScore">0%</p>
    </div>
  </div>
</div>

<script>
const video = document.getElementById('webcam');
const verifyBtn = document.getElementById('verifyBtn');

navigator.mediaDevices.getUserMedia({video:true,audio:true})
.then(stream=>{
    video.srcObject = stream;
    verifyBtn.disabled = false;
    verifyBtn.innerText = "Camera Ready";
})
.catch(err=>{
    verifyBtn.innerText="Camera/Mic Access Denied";
    console.error(err);
});

let featureData={blinking:0,facial:0,voice:0,head:0};
let trendData=[], trendLabels=[];

// Feature Bar
const featureCtx=document.getElementById('featureChart').getContext('2d');
const featureChart=new Chart(featureCtx,{
    type:'bar',
    data:{ labels:['Blinking','Facial','Voice','Head'], datasets:[{ label:'Accuracy %', data:[0,0,0,0], backgroundColor:['#6c63ff','#ff6584','#00d2d3','#ffb400'] }]},
    options:{ responsive:true, animation:{duration:0}, scales:{y:{beginAtZero:true,max:100}} }
});

// Doughnut
const circleCtx=document.getElementById('circleChart').getContext('2d');
const circleChart=new Chart(circleCtx,{
    type:'doughnut',
    data:{ labels:['Blinking','Facial','Voice','Head'], datasets:[{ data:[0,0,0,0], backgroundColor:['#6c63ff','#ff6584','#00d2d3','#ffb400'], borderWidth:0 }] },
    options:{
        responsive:true,
        cutout:'70%',
        plugins:{ legend:{display:false} }
    }
});

// Trend
const trendCtx=document.getElementById('trendChart').getContext('2d');
const trendChart=new Chart(trendCtx,{
    type:'line',
    data:{ labels:trendLabels, datasets:[{ label:'Overall Accuracy %', data:trendData, borderColor:'#ffb400', backgroundColor:'rgba(255,180,0,0.2)', tension:0.2, fill:true }] },
    options:{
        responsive:true,
        animation:{duration:0},
        scales:{y:{beginAtZero:true,max:100}},
        plugins:{
            tooltip:{
                callbacks:{
                    label:function(context){
                        return context.parsed.y.toFixed(1)+'%';
                    }
                }
            }
        }
    }
});

// Simulate Feature Detection (Bar updates live)
function updateFeatureScores(){
    featureData.blinking=Math.floor(Math.random()*100);
    featureData.facial=Math.floor(Math.random()*100);
    featureData.voice=Math.floor(Math.random()*100);
    featureData.head=Math.floor(Math.random()*100);

    featureChart.data.datasets[0].data=[featureData.blinking,featureData.facial,featureData.voice,featureData.head];
    featureChart.update();
}

// Doughnut update every 2 minutes
function updateDoughnut(){
    circleChart.data.datasets[0].data=[featureData.blinking,featureData.facial,featureData.voice,featureData.head];
    circleChart.update();

    let avg=(featureData.blinking+featureData.facial+featureData.voice+featureData.head)/4;
    document.getElementById('overallScore').innerText=avg.toFixed(1)+'%';
}

// Trend updates every second
function updateTrend(){
    let avg=(featureData.blinking+featureData.facial+featureData.voice+featureData.head)/4;
    let now=new Date();
    trendLabels.push(`${now.getHours()}:${now.getMinutes()}:${now.getSeconds()}`);
    trendData.push(avg);
    if(trendData.length>20){ trendData.shift(); trendLabels.shift(); }
    trendChart.update();
}

// Timers
setInterval(updateFeatureScores,1000);      // bar chart live every second
setInterval(updateTrend,1000);             // trend every second
setInterval(updateDoughnut,120000);        // doughnut every 2 minutes

// Initial
updateFeatureScores();
updateTrend();
</script>

</body>
</html>
